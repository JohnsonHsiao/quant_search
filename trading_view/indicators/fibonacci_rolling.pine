

study(title="Fibonacci Rolling", shorttitle="Pivot Points Fibonacci", overlay = true) 
sd = input(true, title="Show Daily Pivots?")
sw = input(false, title="Show 1 Week Pivots?")
sm = input(false, title="Show 2 Hour Pivots?")
sq = input(false, title="Show Hourly Pivots?")
sy = input(false, title="Show 30 Minute Pivots?")
sh3 = input(false, title="Show R3 & S3?")

//Classic Pivot Calculations
pivot = (high + low + close ) / 3.0 
r1 = pivot + 0.382 * (high - low)
s1 = pivot - 0.382 * (high - low) 
r2 = pivot + 0.618 * (high - low) 
s2 = pivot - 0.618 * (high - low) 
r3 = pivot + (high - low)
s3 = pivot - (high - low)

//Daily Pivots 
dtime_pivot = security(tickerid, 'D', pivot[1]) 
dtime_r1 = security(tickerid, 'D', r1[1]) 
dtime_s1 = security(tickerid, 'D', s1[1]) 
dtime_r2 = security(tickerid, 'D', r2[1]) 
dtime_s2 = security(tickerid, 'D', s2[1])
dtime_r3 = security(tickerid, 'D', r3[1])
dtime_s3 = security(tickerid, 'D', s3[1])

offs_daily = 0 
plot(sd and dtime_pivot ? dtime_pivot : na, title="Daily Pivot",style=circles, color=fuchsia,linewidth=4) 
plot(sd and dtime_r1 ? dtime_r1 : na, title="Daily R1",style=circles, color=#DC143C,linewidth=4) 
plot(sd and dtime_s1 ? dtime_s1 : na, title="Daily S1",style=circles, color=lime,linewidth=4) 
plot(sd and dtime_r2 ? dtime_r2 : na, title="Daily R2",style=circles, color=maroon,linewidth=4) 
plot(sd and dtime_s2 ? dtime_s2 : na, title="Daily S2",style=circles, color=#228B22,linewidth=4) 
plot(sd and dtime_r3 ? dtime_r3 : na, title="Daily R3",style=circles, color=#FA8072,linewidth=4)
plot(sd and dtime_s3 ? dtime_s3 : na, title="Daily S3",style=circles, color=#CD5C5C,linewidth=4)

//Weekly Pivots 
wtime_pivot = security(tickerid, '1W', pivot[1]) 
wtime_R1 = security(tickerid, '1W', r1[1]) 
wtime_S1 = security(tickerid, '1W', s1[1])
wtime_R2 = security(tickerid, '1W', r2[1]) 
wtime_S2 = security(tickerid, '1W', s2[1])
wtime_R3 = security(tickerid, '1W', r3[1]) 
wtime_S3 = security(tickerid, '1W', s3[1])

plot(sw and wtime_pivot ? wtime_pivot : na, title="1 Week Pivot",style=circles, color=fuchsia,linewidth=3) 
plot(sw and wtime_R1 ? wtime_R1 : na, title="1 Week R1",style=circles, color=#DC143C,linewidth=3) 
plot(sw and wtime_S1 ? wtime_S1 : na, title="1 Week S1",style=circles, color=lime,linewidth=3) 
plot(sw and wtime_R2 ? wtime_R2 : na, title="1 Week R2",style=circles, color=maroon,linewidth=3) 
plot(sw and wtime_S2 ? wtime_S2 : na, title="1 Week S2",style=circles, color=#228B22,linewidth=3) 
plot(sw and wtime_R3 ? wtime_R3 : na, title="1 Week R3",style=circles, color=#FA8072,linewidth=3) 
plot(sw and wtime_S3 ? wtime_S3 : na, title="1 Week S3",style=circles, color=#CD5C5C,linewidth=3) 

//4 Hour Pivots 
mtime_pivot = security(tickerid, '240', pivot[1]) 
mtime_R1 = security(tickerid, '240', r1[1])
mtime_S1 = security(tickerid, '240', s1[1])
mtime_R2 = security(tickerid, '240', r2[1])
mtime_S2 = security(tickerid, '240', s2[1])
mtime_R3 = security(tickerid, '240', r3[1])
mtime_S3 = security(tickerid, '240', s3[1])

plot(sm and mtime_pivot ? mtime_pivot : na, title="4 Hour Pivot",style=cross, color=fuchsia,linewidth=3) 
plot(sm and mtime_R1 ? mtime_R1 : na, title="4 Hour R1",style=cross, color=#DC143C,linewidth=3) 
plot(sm and mtime_S1 ? mtime_S1 : na, title="4 Hour S1",style=cross, color=lime,linewidth=3) 
plot(sm and mtime_R2 ? mtime_R2 : na, title="4 Hour R2",style=cross, color=maroon,linewidth=3) 
plot(sm and mtime_S2 ? mtime_S2 : na, title="4 Hour S2",style=cross, color=#228B22,linewidth=3)
plot(sm and mtime_R3 ? mtime_R3 : na, title="4 Hour R3",style=cross, color=#FA8072,linewidth=3)
plot(sm and mtime_S3 ? mtime_S3 : na, title="4 Hour S3",style=cross, color=#CD5C5C,linewidth=3)

//1 Hour Pivots
qtime_pivot = security(tickerid, '60', pivot[1]) 
qtime_R1 = security(tickerid, '60', r1[1])
qtime_S1 = security(tickerid, '60', s1[1])
qtime_R2 = security(tickerid, '60', r2[1])
qtime_S2 = security(tickerid, '60', s2[1])
qtime_R3 = security(tickerid, '60', r3[1])
qtime_S3 = security(tickerid, '60', s3[1])
plot(sq and qtime_pivot ? qtime_pivot : na, title="Hourly Pivot",style=circles, color=fuchsia,linewidth=3) 
plot(sq and qtime_R1 ? qtime_R1 : na, title="Hourly R1",style=circles, color=#DC143C,linewidth=3) 
plot(sq and qtime_S1 ? qtime_S1 : na, title="Hourly S1",style=circles, color=lime,linewidth=3) 
plot(sq and qtime_R2 ? qtime_R2 : na, title="Hourly R2",style=circles, color=maroon,linewidth=3) 
plot(sq and qtime_S2 ? qtime_S2 : na, title="Hourly S2",style=circles, color=#228B22,linewidth=3)
plot(sq and qtime_R3 ? qtime_R3 : na, title="Hourly R3",style=circles, color=#FA8072,linewidth=3)
plot(sq and qtime_S3 ? qtime_S3 : na, title="Hourly S3",style=circles, color=#CD5C5C,linewidth=3)

//30 Minute Pivots
ytime_pivot = security(tickerid, '30', pivot[1]) 
ytime_R1 = security(tickerid, '30', r1[1])
ytime_S1 = security(tickerid, '30', s1[1])
ytime_R2 = security(tickerid, '30', r2[1])
ytime_S2 = security(tickerid, '30', s2[1])
ytime_R3 = security(tickerid, '30', r3[1])
ytime_S3 = security(tickerid, '30', s3[1])
plot(sy and ytime_pivot ? ytime_pivot : na, title="30 Minute Pivot",style=cross, color=fuchsia,linewidth=2) 
plot(sy and ytime_R1 ? ytime_R1 : na, title="30 Minute R1",style=cross, color=#DC143C,linewidth=2) 
plot(sy and ytime_S1 ? ytime_S1 : na, title="30 Minute S1",style=cross, color=lime,linewidth=2) 
plot(sy and ytime_R2 ? ytime_R2 : na, title="30 Minute R2",style=cross, color=maroon,linewidth=2) 
plot(sy and ytime_S2 ? ytime_S2 : na, title="30 Minute S2",style=cross, color=#228B22,linewidth=2)
plot(sy and ytime_R3 ? ytime_R3 : na, title="30 Minute R3",style=cross, color=#FA8072,linewidth=2)
plot(sy and ytime_S3 ? ytime_S3 : na, title="30 Minute S3",style=cross, color=#CD5C5C,linewidth=2)